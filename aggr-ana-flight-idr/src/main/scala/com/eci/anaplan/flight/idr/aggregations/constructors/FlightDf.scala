package com.eci.anaplan.flight.idr.aggregations.constructors

import com.eci.anaplan.flight.idr.services.S3SourceService
import org.apache.spark.sql.{DataFrame, SparkSession}

import javax.inject.{Inject, Singleton}

@Singleton
class FlightDf @Inject()(val sparkSession: SparkSession, s3SourceService: S3SourceService) {

  import sparkSession.implicits._

  def get: DataFrame = {
    s3SourceService.FlightDataFrame
      .select(
          $"booking_issue_date",
          $"locale",
          $"product_type",
          $"business_model",
          $"booking_id",
          $"fulfillment_id",
          $"airline_id",
          $"brand_codes",
          $"provider_pnr",
          $"airline_pnr",
          $"departure_date",
          $"non_refundable_date",
          $"contract_entity",
          $"trip_type",
          $"route",
          $"airport_countries",
          $"number_of_segments",
          $"subclass",
          $"adults__pax_",
          $"children__pax_",
          $"infants__pax_",
          $"total_segments_pax__exclude_infant_",
          $"collecting_entity",
          $"payment_scope",
          $"bank_names",
          $"installment_code",
          $"payment_fee",
          $"mdr_installment",
          $"coupon_code",
          $"gift_voucher_code",
          $"contract_currency",
          $"total_fare__contract_currency_",
          $"issuance_fee",
          $"airline_reschedule_fee__contract_currency_",
          $"total_agent_fare__contract_currency_",
          $"traveloka_reschedule_fee__contract_currency_",
          $"unique_code__contract_currency_",
          $"base_fare_adult__per_pax_",
          $"base_fare_child__per_pax_",
          $"base_fare_infant__per_pax_",
          $"total_base_fare__exclude_infant_",
          $"new_gross_commission",
          $"commission_tax",
          $"net_commission",
          $"nta",
          $"bta",
          $"commission_rule_id",
          $"commission_version",
          $"basic_incentive",
          $"incentive_rule_id",
          $"incentive_rule_version",
          $"collecting_currency",
          $"invoice_amount",
          $"total_fare__collecting_currency_",
          $"discount_premium",
          $"total_agent_fare",
          $"package_discount_premium",
          $"unique_code",
          $"coupon_value",
          $"gift_voucher_value",
          $"airline_reschedule_fee__collecting_currency_",
          $"traveloka_reschedule_fee",
          $"installment_request",
          $"transaction_fee",
          $"point_redemption",
          $"rebook_cost",
          $"is_cross_selling_",
          $"reschedule_id",
          $"corporate_id",
          $"corporate_type",
          $"affiliate_id",
          $"commission_to_affiliate",
          $"customer_country",
          $"vat_fee",
          $"billing_amount",
          $"seat_published_class",
          $"commission_to_collecting_entity",
          $"non_connecting_discount_premium",
          $"reschedule_mark_up",
          $"is_credit_shell",
          $"commission_type",
          $"commission_adult_formula",
          $"commission_children__formula",
          $"commission_infant_formula",
          $"incentive_type",
          $"basic_incentive_adult_formula",
          $"basic_incentive_children_formula",
          $"basic_incentive_infant_formula",
          $"settlement_currency",
          $"billing_amount__settlement_currency_",
          $"total_fare__settlement_currency_",
          $"airline_reschedule_fee__settlement_currency_",
          $"traveloka_reschedule_fee__settlement_currency_",
          $"unique_code__settlement_currency_",
          $"base_fare_adult_per_pax__settlement_currency_",
          $"base_fare_child_per_pax__settlement_currency_",
          $"total_base_fare_exclude_infant__settlement_currency_",
          $"new_gross_commission__settlement_currency_",
          $"commission_tax__settlement_currency_",
          $"net_commission__settlement_currency_",
          $"basic_incentive__settlement_currency_",
          $"bta__settlement_currency_",
          $"issuance_fee__settlement_currency_",
          $"total_agent_fare__settlement_currency_",
          $"fare_basis",
          $"issuance_fare_source",
          $"discount_wht",
          $"coupon_wht",
          $"osi_code",
          $"redirection_partner",
          $"redirection_base_marketing_fee__collecting_currency_",
          $"flight_code",
          $"vat_out",
          $"no_hold_booking_cost",
          $"credit_shell_amount",
          $"credit_shell_amount__settlement_currency_",
          $"base_fare_infant_per_pax__settlement_currency_",
          $"nta__settlement_currency_",
          $"business_partner_id",
          $"inventory_amount",
          $"infant_fare_before_vat",
          $"selling_entity"
      )
  }
}